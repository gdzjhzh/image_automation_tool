# Image Automation Tool

批量图片风格化与防重复检测工具。核心目标：

- 一键批量规范图片尺寸、边框与整体风格。
- 通过多种轻量扰动与微痕水印规避平台重复内容检测。
- 提供高性能并发处理、实时进度与详细报告。
- 除命令行之外，提供 Tkinter GUI 以满足内部运营团队使用。

## 模块分层

```
src/image_automation
├── cli/          # Typer 命令行入口
├── core/         # 任务调度、配置解析、日志、报告
├── processing/   # 图像处理与防检测算法
├── gui/          # Tkinter 界面
└── utils/        # 通用工具函数与常量
```

处理流程：

1. 解析输入参数（CLI/GUI）并构建 `JobConfig`。
2. 文件扫描模块生成处理队列，跳过非图片与损坏文件。
3. 风格化与防检测流水线在独立进程中执行，产出结果并写入报告。
4. 主线程刷新进度条、日志并在任务结束后输出 CSV 报告。

## 开发阶段划分

1. **项目骨架与基础设施**：完成目录结构、依赖定义与配置约定。
2. **文件扫描与基础预处理**（当前阶段）：实现递归扫描、EXIF 校正、色彩空间转换与错误处理。
3. **风格化与输出管理**：完成尺寸适配、边框处理、输出策略与报告写入。
4. **防检测引擎**：实现多种随机扰动、微痕水印与模式配置。
5. **并发、Tkinter GUI 与回归验证**：集成多进程、GUI 入口，完善测试与文档。

每一阶段完成后会执行验证并打标签备份，以确保增量迭代的稳定性。

## GUI 参数说明

- **防检测模式**  
  - `none`: 仅执行风格化，不做任何防重复处理。  
  - `light`: 轻度随机抖动（亮度/对比度/饱和度）与低强度噪点。  
  - `medium`: 在 `light` 基础上增加微小随机旋转与裁剪。  
  - `heavy`: 在 `medium` 基础上叠加多重“数字微痕”水印，数量/位置/透明度均随机。

- **水印数量 / 透明度 / 缩放范围**  
  两个输入框分别代表“最小值”和“最大值”，运行时会在该范围内随机取值。若希望固定数值，可把最小值和最大值设置为同一数字。

- **冲突策略 (`--on-conflict`)**  
  - `rename`: 发现同名文件即自动重命名（如 `image.png` → `image_1.png`）。  
  - `overwrite`: 覆盖已有文件。  
  - `skip`: 跳过该文件并在报告中记录“已存在，已跳过”。

- **随机种子**  
  留空时每次运行都会使用新的随机序列；输入任意整数（推荐 0～4294967295）即可锁定随机扰动，便于复现同一批结果。
